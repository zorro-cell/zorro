function fetchWeibo(callback) {
  const url = "https://weibo.com/ajax/side/hotSearch";
  const headers = {
    "User-Agent": "Mozilla/5.0 (iPhone; CPU iPhone OS 16_6 like Mac OS X)"
  };
  $httpClient.get({ url, headers }, (err, resp, data) => {
    console.log("ğŸ” å¾®åšæ¥å£çŠ¶æ€ç :", resp?.status || 'æ— ');
    if (err || !data) {
      console.log("âŒ å¾®åšè¯·æ±‚é”™è¯¯:", err);
      return callback(["å¾®åšçƒ­æœè·å–å¤±è´¥"]);
    }
    try {
      console.log("ğŸ“„ å¾®åšè¿”å›æ•°æ®é¢„è§ˆ:", data.slice(0, 100));
      const json = JSON.parse(data);
      const list = json.data.realtime.slice(0, 5);
      const result = list.map((x, i) => `${i + 1}. å¾®åšçƒ­æœï¼š${x.word}`);
      callback(result);
    } catch (e) {
      console.log("âŒ å¾®åšè§£æå¤±è´¥:", e.message);
      callback([`å¾®åšçƒ­æœè§£æå¤±è´¥ï¼š${e.message}`]);
    }
  });
}

function fetchBing(callback) {
  const url = "https://www.bing.com/news/search?q=world+news&format=rss&count=5";
  const headers = {
    "User-Agent": "Mozilla/5.0 (iPhone; CPU iPhone OS 16_6 like Mac OS X)"
  };
  $httpClient.get({ url, headers }, (err, resp, data) => {
    console.log("ğŸ” Bing æ¥å£çŠ¶æ€ç :", resp?.status || 'æ— ');
    if (err || !data) {
      console.log("âŒ Bing è¯·æ±‚é”™è¯¯:", err);
      return callback(["å›½é™…æ–°é—»è·å–å¤±è´¥"]);
    }
    try {
      console.log("ğŸ“„ Bing è¿”å›æ•°æ®é¢„è§ˆ:", data.slice(0, 100));
      const items = data.match(/<title>([^<]+)<\/title>/g)?.slice(1, 6) || [];
      const result = items.map((t, i) => `${i + 6}. å›½é™…æ–°é—»ï¼š${t.replace(/<\/?title>/g, "")}`);
      callback(result);
    } catch (e) {
      console.log("âŒ Bing è§£æå¤±è´¥:", e.message);
      callback([`å›½é™…æ–°é—»è§£æå¤±è´¥ï¼š${e.message}`]);
    }
  });
}

fetchWeibo((wbList) => {
  fetchBing((bnList) => {
    const lines = wbList.concat(bnList).slice(0, 10);
    const msg = lines.join("\n");
    console.log("âœ… æœ€ç»ˆç®€è®¯ï¼š\n" + msg);
    $notification.post("ğŸ“° æ¯æ—¥ç®€è®¯", "å¾®åšçƒ­æœ + å›½é™…å¤´æ¡", msg);
    $done({ body: JSON.stringify({ list: lines }) });
  });
});

[Script]
http-response ^https:\/\/daily\.news\.proxy\/news script-path=https://raw.githubusercontent.com/ä½ çš„ç”¨æˆ·å/ä½ çš„ä»“åº“å/main/daily_digest.js, requires-body=0, max-size=0, timeout=20, tag=daily_digest

[Cron]
0 8 * * * script-path=https://raw.githubusercontent.com/zorro-cell/zorro/main/daily_digest.js, timeout=20, tag=daily_digest_cron

[MITM]
hostname = daily.news.proxy